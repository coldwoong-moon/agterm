# AgTerm v2 - AI Agent Terminal Orchestrator

## ê°œì • ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ì‚¬í•­ |
|-----|------|----------|
| v1.0 | 2026-01-17 | ì´ˆì•ˆ ì‘ì„± |
| v2.0 | 2026-01-17 | Momus ê²€í†  ë°˜ì˜, Context Engineering íŒ¨í„´ ì ìš©, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ ê²€ì¦ |

---

## 1. í”„ë¡œì íŠ¸ ë¹„ì „

**AgTerm**ì€ AI ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹œê°ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ì°¨ì„¸ëŒ€ í„°ë¯¸ë„ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ì…ë‹ˆë‹¤.

### í•µì‹¬ ê°€ì¹˜ ì œì•ˆ
1. **Tree ê¸°ë°˜ ì‘ì—… ë¶„ê¸°**: í•˜ë‚˜ì˜ ìš”ì²­ì´ ì—¬ëŸ¬ ë³‘ë ¬ í„°ë¯¸ë„ë¡œ ë¶„ê¸°
2. **ì‹¤ì‹œê°„ ì‹œê°í™”**: ì‘ì—… ì§„í–‰ ìƒí™©ì„ ê·¸ë˜í”„ë¡œ í‘œì‹œ
3. **ì§€ëŠ¥í˜• ì•„ì¹´ì´ë¹™**: ì„¸ì…˜ íˆìŠ¤í† ë¦¬ë¥¼ AIë¡œ ìš”ì•½í•˜ì—¬ ë‹¤ìŒ ì„¸ì…˜ì— í™œìš©
4. **MCP ë„¤ì´í‹°ë¸Œ**: Model Context Protocolì„ 1ê¸‰ ì‹œë¯¼ìœ¼ë¡œ ì§€ì›

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 2.1 ë ˆì´ì–´ ì•„í‚¤í…ì²˜ (ì˜ì¡´ì„± ë°©í–¥ ëª…ì‹œ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Presentation Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   TUI App   â”‚  â”‚ Graph View  â”‚  â”‚    Status Bar           â”‚  â”‚
â”‚  â”‚  (ratatui)  â”‚  â”‚ (petgraph)  â”‚  â”‚                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                â”‚                      â”‚                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â”‚ implements                            â”‚
â”‚                          â–¼                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Application Layer (Traits)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  trait TaskOrchestrator    trait SessionManager             â”‚ â”‚
â”‚  â”‚  trait EventPublisher      trait ArchiveStore               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â–²                                       â”‚
â”‚                          â”‚ implements                            â”‚
â”‚                          â”‚                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Domain Layer (Core Logic)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ TaskManager â”‚  â”‚ EventBus    â”‚  â”‚    Compactor            â”‚  â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚    (AI Summarizer)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                â”‚                      â”‚                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Infrastructure Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PTY Pool   â”‚  â”‚ MCP Client  â”‚  â”‚    SQLite Store         â”‚  â”‚
â”‚  â”‚(portable-ptyâ”‚  â”‚   (rmcp)    â”‚  â”‚                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì˜ì¡´ì„± ë°©í–¥: Presentation â†’ Application â† Domain â† Infrastructure
(ì˜ì¡´ì„± ì—­ì „ ì›ì¹™ ì ìš©: ìƒìœ„ ë ˆì´ì–´ê°€ í•˜ìœ„ ë ˆì´ì–´ì˜ ì¶”ìƒí™”ì— ì˜ì¡´)
```

### 2.2 ì´ë²¤íŠ¸ íë¦„ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Event Flow                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  [User Input]                                                    â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    TaskCreated     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚   TUI   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  EventBus   â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚       â–²                                â”‚                         â”‚
â”‚       â”‚ RenderRequest                  â”‚                         â”‚
â”‚       â”‚                                â–¼                         â”‚
â”‚       â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚       â”‚    TaskStateChanged     â”‚ TaskManager â”‚                 â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚             â”‚                 â”‚
â”‚                                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                        â”‚                         â”‚
â”‚                    PtyOutput           â”‚ SpawnPty                â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚            â”‚                                                     â”‚
â”‚            â–¼                                                     â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚       â”‚PTY Pool â”‚                                               â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚                                                                  â”‚
â”‚  Event Types:                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  â€¢ TaskCreated { id, name, command, parent_id }                 â”‚
â”‚  â€¢ TaskStateChanged { id, old_state, new_state }                â”‚
â”‚  â€¢ PtyOutput { task_id, data: Vec<u8> }                         â”‚
â”‚  â€¢ PtyExited { task_id, exit_code }                             â”‚
â”‚  â€¢ RenderRequest { dirty_regions: Vec<Region> }                 â”‚
â”‚  â€¢ McpResponse { request_id, result }                           â”‚
â”‚  â€¢ ArchiveRequest { session_id }                                â”‚
â”‚                                                                  â”‚
â”‚  Channel Strategy:                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚  â€¢ tokio::sync::broadcast - 1:N ì´ë²¤íŠ¸ (TaskStateChanged)       â”‚
â”‚  â€¢ tokio::sync::mpsc - N:1 ì´ë²¤íŠ¸ (PtyOutput)                   â”‚
â”‚  â€¢ Buffer size: 1024 (configurable)                             â”‚
â”‚  â€¢ Backpressure: Lagging receivers get SendError                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 MCP ì—­í•  ëª…í™•í™”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AgTerm's MCP Roles                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    AS MCP CLIENT                            â”‚â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚â”‚
â”‚  â”‚  AgTerm connects TO external MCP servers                    â”‚â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     stdio/SSE     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚â”‚
â”‚  â”‚  â”‚ AgTerm  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ filesystem server â”‚       â”‚â”‚
â”‚  â”‚  â”‚ (client)â”‚     stdio/SSE     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚â”‚
â”‚  â”‚  â”‚         â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ github server     â”‚       â”‚â”‚
â”‚  â”‚  â”‚         â”‚     stdio/SSE     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚â”‚
â”‚  â”‚  â”‚         â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ context-7 server  â”‚       â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â”‚  Use Cases:                                                 â”‚â”‚
â”‚  â”‚  â€¢ Call filesystem tools (read_file, write_file)            â”‚â”‚
â”‚  â”‚  â€¢ Query GitHub (create_issue, search_code)                 â”‚â”‚
â”‚  â”‚  â€¢ Fetch documentation (get-library-docs)                   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    AS MCP SERVER (Future v1.0+)             â”‚â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚â”‚
â”‚  â”‚  AgTerm exposes terminal capabilities TO external clients   â”‚â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     stdio      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚â”‚
â”‚  â”‚  â”‚ Claude Code       â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ AgTerm  â”‚          â”‚â”‚
â”‚  â”‚  â”‚ (or other agents) â”‚                â”‚ (server)â”‚          â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â”‚  Exposed Tools:                                             â”‚â”‚
â”‚  â”‚  â€¢ spawn_terminal(command) -> terminal_id                   â”‚â”‚
â”‚  â”‚  â€¢ read_output(terminal_id) -> string                       â”‚â”‚
â”‚  â”‚  â€¢ send_input(terminal_id, input) -> void                   â”‚â”‚
â”‚  â”‚  â€¢ get_task_tree() -> TaskTree                              â”‚â”‚
â”‚  â”‚  â€¢ archive_session() -> archive_id                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â”‚  Implementation Priority:                                        â”‚
â”‚  â€¢ Phase 5 (v0.5): MCP Client only                              â”‚
â”‚  â€¢ Phase 7+ (v1.0+): MCP Server (optional feature)              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Context Engineering ì „ëµ

> ì°¸ì¡°: [Anthropic - Effective Context Engineering](https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents)

### 3.1 ë„¤ ê°€ì§€ í•µì‹¬ íŒ¨í„´ ì ìš©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Context Engineering for AgTerm                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. WRITE (ì™¸ë¶€ ì €ì¥)                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â”‚
â”‚  â€¢ í„°ë¯¸ë„ ì¶œë ¥ â†’ íŒŒì¼ ì‹œìŠ¤í…œ (raw logs)                          â”‚
â”‚  â€¢ ì‘ì—… ìƒíƒœ â†’ SQLite (structured data)                          â”‚
â”‚  â€¢ ì„¸ì…˜ ìš”ì•½ â†’ Archive store                                     â”‚
â”‚                                                                  â”‚
â”‚  2. SELECT (ë™ì  ê²€ìƒ‰)                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚
â”‚  â€¢ ê´€ë ¨ ì´ì „ ì„¸ì…˜ ê²€ìƒ‰ (by working_dir, tags)                    â”‚
â”‚  â€¢ ìœ ì‚¬ ëª…ë ¹ì–´ íˆìŠ¤í† ë¦¬ ì¡°íšŒ                                      â”‚
â”‚  â€¢ MCP ì„œë²„ì—ì„œ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ fetch                              â”‚
â”‚                                                                  â”‚
â”‚  3. COMPRESS (í† í° ìµœì í™”)                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Compression Pipeline                                        â”‚â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â”‚ [Raw Output]                                                â”‚â”‚
â”‚  â”‚      â”‚                                                      â”‚â”‚
â”‚  â”‚      â–¼                                                      â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚â”‚
â”‚  â”‚ â”‚ 1. Compaction    â”‚ â† ê°€ì—­ì : íŒŒì¼ ê²½ë¡œë§Œ ìœ ì§€              â”‚â”‚
â”‚  â”‚ â”‚    (Reversible)  â”‚   "Output saved to /tmp/build.log"     â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚â”‚
â”‚  â”‚          â”‚ if still too large                               â”‚â”‚
â”‚  â”‚          â–¼                                                  â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚â”‚
â”‚  â”‚ â”‚ 2. Summarization â”‚ â† ë¹„ê°€ì—­: AI ê¸°ë°˜ ìš”ì•½                  â”‚â”‚
â”‚  â”‚ â”‚    (Lossy)       â”‚   "ë¹Œë“œ ì„±ê³µ, 42 ëª¨ë“ˆ ì»´íŒŒì¼"           â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚â”‚
â”‚  â”‚          â”‚ for long-term storage                            â”‚â”‚
â”‚  â”‚          â–¼                                                  â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚â”‚
â”‚  â”‚ â”‚ 3. Hierarchical  â”‚ â† ì ì§„ì : ì˜¤ë˜ëœ ìš”ì•½ ì¬ì••ì¶•            â”‚â”‚
â”‚  â”‚ â”‚    Rolling       â”‚   "ì´ë²ˆ ì£¼: 15ê°œ ë¹Œë“œ, 3ê°œ ì‹¤íŒ¨"        â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â”‚  4. ISOLATE (ì»¨í…ìŠ¤íŠ¸ ë¶„ë¦¬)                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
â”‚  â€¢ ê° í„°ë¯¸ë„ ì„¸ì…˜ = ë…ë¦½ëœ ì»¨í…ìŠ¤íŠ¸ ìœˆë„ìš°                       â”‚
â”‚  â€¢ ë¶€ëª¨ íƒœìŠ¤í¬ì—ê²ŒëŠ” ìì‹ì˜ ìš”ì•½ë§Œ ì „ë‹¬                          â”‚
â”‚  â€¢ "Share memory by communicating" ì›ì¹™                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Memory Block êµ¬ì¡°

```rust
/// Memory Block - ì»¨í…ìŠ¤íŠ¸ ìœˆë„ìš°ì˜ êµ¬ì¡°í™”ëœ ë‹¨ìœ„
/// ì°¸ì¡°: Letta Memory Blocks (MemGPT)
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct MemoryBlock {
    /// ë¸”ë¡ì˜ ëª©ì ì„ ì‹ë³„í•˜ëŠ” ë¼ë²¨
    pub label: MemoryBlockLabel,

    /// ë¸”ë¡ ë°ì´í„°ì˜ ë¬¸ìì—´ í‘œí˜„
    pub value: String,

    /// ìµœëŒ€ í† í° ìˆ˜ ì œí•œ
    pub token_limit: usize,

    /// í˜„ì¬ í† í° ìˆ˜ (ì¶”ì •)
    pub current_tokens: usize,

    /// ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„
    pub updated_at: DateTime<Utc>,
}

#[derive(Debug, Clone, Serialize, Deserialize)]
pub enum MemoryBlockLabel {
    /// í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬ ë° í™˜ê²½ ì •ë³´
    WorkingContext,

    /// ì§„í–‰ ì¤‘ì¸ íƒœìŠ¤í¬ ëª©ë¡ (Scratchpad)
    TaskProgress,

    /// ìµœê·¼ í„°ë¯¸ë„ ì¶œë ¥ (sliding window)
    RecentOutput,

    /// ì´ì „ ì„¸ì…˜ì—ì„œ ê°€ì ¸ì˜¨ ì»¨í…ìŠ¤íŠ¸
    SessionHistory,

    /// MCP ì„œë²„ ìƒíƒœ ë° ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬
    McpContext,
}

/// ì˜ˆì‹œ: TaskProgress ë¸”ë¡
/// ```
/// ## Current Tasks
/// - [x] npm install (completed, 45s)
/// - [>] npm run build (running, 2m 15s elapsed)
/// - [ ] npm test (pending, depends on: build)
///
/// ## Notes
/// - Build using webpack 5
/// - 3 warnings in src/utils.ts
/// ```
```

### 3.3 Compaction ì „ëµ ìƒì„¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Compaction Strategy                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  STEP 1: Output Reference (Always)                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               â”‚
â”‚  Before: "npm run build\n> webpack 5.90.0\n> Compiled           â”‚
â”‚           successfully in 2345ms\n> 42 modules..."              â”‚
â”‚  After:  "$ npm run build â†’ success (see: .agterm/logs/abc.log)"â”‚
â”‚                                                                  â”‚
â”‚  Implementation:                                                 â”‚
â”‚  ```rust                                                         â”‚
â”‚  fn compact_output(output: &str, task_id: &Uuid) -> CompactedOutput {â”‚
â”‚      // 1. ì „ì²´ ì¶œë ¥ì„ íŒŒì¼ë¡œ ì €ì¥                                â”‚
â”‚      let log_path = save_to_log(output, task_id);                â”‚
â”‚                                                                  â”‚
â”‚      // 2. ë§ˆì§€ë§‰ Nì¤„ë§Œ ìœ ì§€ (configurable, default: 10)         â”‚
â”‚      let last_lines = output.lines().rev().take(10).collect();   â”‚
â”‚                                                                  â”‚
â”‚      // 3. ì°¸ì¡° í¬í•¨ ìš”ì•½ ìƒì„±                                    â”‚
â”‚      CompactedOutput {                                           â”‚
â”‚          summary: extract_key_info(output),                      â”‚
â”‚          last_lines,                                             â”‚
â”‚          full_log_path: log_path,                                â”‚
â”‚      }                                                           â”‚
â”‚  }                                                               â”‚
â”‚  ```                                                             â”‚
â”‚                                                                  â”‚
â”‚  STEP 2: AI Summarization (When needed)                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚  Trigger: ì„¸ì…˜ ì¢…ë£Œ ì‹œ ë˜ëŠ” í† í° ì„ê³„ê°’(128k) ë„ë‹¬ ì‹œ            â”‚
â”‚                                                                  â”‚
â”‚  Prompt Template:                                                â”‚
â”‚  ```                                                             â”‚
â”‚  ë‹¤ìŒ í„°ë¯¸ë„ ì„¸ì…˜ ë¡œê·¸ë¥¼ ìš”ì•½í•´ì£¼ì„¸ìš”.                            â”‚
â”‚  - ì‹¤í–‰ëœ ì£¼ìš” ëª…ë ¹ì–´                                            â”‚
â”‚  - ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ ë° í•µì‹¬ ê²°ê³¼                                   â”‚
â”‚  - ë°œìƒí•œ ì—ëŸ¬ ë©”ì‹œì§€ (ìˆëŠ” ê²½ìš°)                                â”‚
â”‚  - ë‹¤ìŒ ì„¸ì…˜ì—ì„œ ì°¸ê³ í•  ë§Œí•œ ì •ë³´                                â”‚
â”‚                                                                  â”‚
â”‚  ë¡œê·¸:                                                           â”‚
â”‚  {log_content}                                                   â”‚
â”‚  ```                                                             â”‚
â”‚                                                                  â”‚
â”‚  AI Provider Options:                                            â”‚
â”‚  â€¢ Local: ollama (llama3.2, qwen2.5)                            â”‚
â”‚  â€¢ Cloud: Claude API (claude-3-haiku for cost efficiency)       â”‚
â”‚  â€¢ Configurable via settings                                     â”‚
â”‚                                                                  â”‚
â”‚  STEP 3: Hierarchical Rolling (For archives)                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”‚
â”‚  Daily summaries â†’ Weekly summaries â†’ Monthly summaries          â”‚
â”‚                                                                  â”‚
â”‚  Storage Schema:                                                 â”‚
â”‚  ```sql                                                          â”‚
â”‚  CREATE TABLE summaries (                                        â”‚
â”‚      id TEXT PRIMARY KEY,                                        â”‚
â”‚      level TEXT CHECK(level IN ('session','daily','weekly')),   â”‚
â”‚      period_start TIMESTAMP,                                     â”‚
â”‚      period_end TIMESTAMP,                                       â”‚
â”‚      content TEXT,                                               â”‚
â”‚      token_count INTEGER,                                        â”‚
â”‚      parent_id TEXT REFERENCES summaries(id)                     â”‚
â”‚  );                                                              â”‚
â”‚  ```                                                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ë°ì´í„° ëª¨ë¸ (ìƒì„¸)

### 4.1 í•µì‹¬ ì—”í‹°í‹°

```rust
//===================================================================
// Task Graph
//===================================================================

use petgraph::graph::DiGraph;
use uuid::Uuid;
use chrono::{DateTime, Utc};

/// íƒœìŠ¤í¬ ë…¸ë“œ - ê·¸ë˜í”„ì˜ ê° ë…¸ë“œ
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct TaskNode {
    pub id: Uuid,
    pub name: String,
    pub command: String,
    pub working_dir: PathBuf,
    pub status: TaskStatus,
    pub pty_id: Option<PtyId>,

    // íƒ€ì´ë°
    pub created_at: DateTime<Utc>,
    pub started_at: Option<DateTime<Utc>>,
    pub completed_at: Option<DateTime<Utc>>,

    // ê²°ê³¼
    pub exit_code: Option<i32>,
    pub output_log_path: Option<PathBuf>,  // ì „ì²´ ë¡œê·¸ íŒŒì¼ ê²½ë¡œ
    pub output_summary: String,             // ìš”ì•½ (compact)

    // ë©”íƒ€ë°ì´í„°
    pub tags: Vec<String>,
    pub metadata: HashMap<String, serde_json::Value>,
}

#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize)]
pub enum TaskStatus {
    Pending,     // ëŒ€ê¸° ì¤‘ (ì˜ì¡´ì„± ë¯¸ì¶©ì¡±)
    Queued,      // ëŒ€ê¸° ì¤‘ (ì‹¤í–‰ ê°€ëŠ¥)
    Running,     // ì‹¤í–‰ ì¤‘
    Completed,   // ì„±ê³µì  ì™„ë£Œ
    Failed,      // ì‹¤íŒ¨
    Cancelled,   // ì‚¬ìš©ì ì·¨ì†Œ
    Timeout,     // ì‹œê°„ ì´ˆê³¼
}

/// íƒœìŠ¤í¬ ê°„ ì—£ì§€ - ì˜ì¡´ì„± ê´€ê³„
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct TaskEdge {
    pub edge_type: TaskEdgeType,
    pub created_at: DateTime<Utc>,
}

#[derive(Debug, Clone, Copy, Serialize, Deserialize)]
pub enum TaskEdgeType {
    /// Aê°€ ì™„ë£Œëœ í›„ B ì‹œì‘ (A â†’ B)
    DependsOn,

    /// Aê°€ Bë¥¼ ìƒì„±í•¨ (parent â†’ child)
    SpawnedBy,

    /// Aì™€ Bê°€ ë™ì‹œ ì‹¤í–‰ ê°€ëŠ¥
    Parallel,
}

/// íƒœìŠ¤í¬ ê·¸ë˜í”„ ì „ì²´
pub type TaskGraph = DiGraph<TaskNode, TaskEdge>;

//===================================================================
// Session & Archive
//===================================================================

/// ì„¸ì…˜ - í•˜ë‚˜ì˜ AgTerm ì‹¤í–‰ ë‹¨ìœ„
#[derive(Debug, Serialize, Deserialize)]
pub struct Session {
    pub id: Uuid,
    pub working_dir: PathBuf,
    pub started_at: DateTime<Utc>,
    pub ended_at: Option<DateTime<Utc>>,

    /// íƒœìŠ¤í¬ ê·¸ë˜í”„ (ì„¸ì…˜ ë‚´ ëª¨ë“  íƒœìŠ¤í¬)
    pub task_graph: TaskGraph,

    /// MCP ì—°ê²° ìƒíƒœ
    pub mcp_connections: Vec<McpConnectionState>,

    /// ë©”ëª¨ë¦¬ ë¸”ë¡ë“¤
    pub memory_blocks: HashMap<MemoryBlockLabel, MemoryBlock>,
}

/// ì•„ì¹´ì´ë¸Œ - ì €ì¥ëœ ì„¸ì…˜
#[derive(Debug, Serialize, Deserialize)]
pub struct SessionArchive {
    pub id: Uuid,
    pub session_id: Uuid,
    pub working_dir: PathBuf,
    pub period: (DateTime<Utc>, DateTime<Utc>),

    /// AI ìƒì„± ìš”ì•½
    pub summary: String,

    /// ê²€ìƒ‰ìš© íƒœê·¸
    pub tags: Vec<String>,

    /// ë©”íŠ¸ë¦­
    pub metrics: SessionMetrics,

    /// ì••ì¶• ë ˆë²¨
    pub compression_level: CompressionLevel,
}

#[derive(Debug, Serialize, Deserialize)]
pub struct SessionMetrics {
    pub total_tasks: usize,
    pub successful_tasks: usize,
    pub failed_tasks: usize,
    pub cancelled_tasks: usize,
    pub total_duration_secs: f64,
    pub avg_task_duration_secs: f64,
    pub max_parallelism: usize,        // ë™ì‹œ ì‹¤í–‰ ìµœëŒ€ íƒœìŠ¤í¬ ìˆ˜
    pub total_output_bytes: usize,
    pub compressed_output_bytes: usize,
}

#[derive(Debug, Clone, Copy, Serialize, Deserialize)]
pub enum CompressionLevel {
    /// ì›ë³¸ ìœ ì§€ (ìµœê·¼ ì„¸ì…˜)
    Raw,
    /// Compaction ì ìš© (ì°¸ì¡°ë§Œ ìœ ì§€)
    Compacted,
    /// AI ìš”ì•½ ì ìš©
    Summarized,
    /// ê³„ì¸µì  ë¡¤ë§ ìš”ì•½
    Rolled,
}
```

### 4.2 SQLite ìŠ¤í‚¤ë§ˆ

```sql
-- ì„¸ì…˜ í…Œì´ë¸”
CREATE TABLE sessions (
    id TEXT PRIMARY KEY,
    working_dir TEXT NOT NULL,
    started_at TEXT NOT NULL,  -- ISO 8601
    ended_at TEXT,
    status TEXT CHECK(status IN ('active', 'completed', 'crashed')) DEFAULT 'active'
);

-- íƒœìŠ¤í¬ í…Œì´ë¸”
CREATE TABLE tasks (
    id TEXT PRIMARY KEY,
    session_id TEXT NOT NULL REFERENCES sessions(id),
    parent_id TEXT REFERENCES tasks(id),
    name TEXT NOT NULL,
    command TEXT NOT NULL,
    working_dir TEXT NOT NULL,
    status TEXT NOT NULL,
    created_at TEXT NOT NULL,
    started_at TEXT,
    completed_at TEXT,
    exit_code INTEGER,
    output_log_path TEXT,
    output_summary TEXT,
    metadata TEXT  -- JSON
);

-- íƒœìŠ¤í¬ ì˜ì¡´ì„±
CREATE TABLE task_edges (
    from_task_id TEXT NOT NULL REFERENCES tasks(id),
    to_task_id TEXT NOT NULL REFERENCES tasks(id),
    edge_type TEXT NOT NULL,
    created_at TEXT NOT NULL,
    PRIMARY KEY (from_task_id, to_task_id)
);

-- ì•„ì¹´ì´ë¸Œ í…Œì´ë¸”
CREATE TABLE archives (
    id TEXT PRIMARY KEY,
    session_id TEXT NOT NULL REFERENCES sessions(id),
    working_dir TEXT NOT NULL,
    period_start TEXT NOT NULL,
    period_end TEXT NOT NULL,
    summary TEXT NOT NULL,
    compression_level TEXT NOT NULL,
    metrics TEXT NOT NULL,  -- JSON
    created_at TEXT NOT NULL
);

-- ì•„ì¹´ì´ë¸Œ íƒœê·¸ (ë‹¤ëŒ€ë‹¤)
CREATE TABLE archive_tags (
    archive_id TEXT NOT NULL REFERENCES archives(id),
    tag TEXT NOT NULL,
    PRIMARY KEY (archive_id, tag)
);

-- ì „ë¬¸ ê²€ìƒ‰ ì¸ë±ìŠ¤ (FTS5)
CREATE VIRTUAL TABLE archives_fts USING fts5(
    summary,
    content='archives',
    content_rowid='rowid'
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_tasks_session ON tasks(session_id);
CREATE INDEX idx_tasks_status ON tasks(status);
CREATE INDEX idx_archives_working_dir ON archives(working_dir);
CREATE INDEX idx_archive_tags_tag ON archive_tags(tag);
```

---

## 5. ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ

### 5.1 ì—ëŸ¬ ê³„ì¸µ êµ¬ì¡°

```rust
use thiserror::Error;

/// ìµœìƒìœ„ ì—ëŸ¬ íƒ€ì…
#[derive(Error, Debug)]
pub enum AgTermError {
    #[error("PTY error: {0}")]
    Pty(#[from] PtyError),

    #[error("MCP error: {0}")]
    Mcp(#[from] McpError),

    #[error("Storage error: {0}")]
    Storage(#[from] StorageError),

    #[error("Task error: {0}")]
    Task(#[from] TaskError),

    #[error("Configuration error: {0}")]
    Config(#[from] ConfigError),
}

#[derive(Error, Debug)]
pub enum PtyError {
    #[error("Failed to spawn PTY: {0}")]
    SpawnFailed(String),

    #[error("PTY pool exhausted (max: {max})")]
    PoolExhausted { max: usize },

    #[error("PTY {id} not found")]
    NotFound { id: PtyId },

    #[error("PTY I/O error: {0}")]
    Io(#[from] std::io::Error),
}

#[derive(Error, Debug)]
pub enum McpError {
    #[error("Connection failed to {server}: {reason}")]
    ConnectionFailed { server: String, reason: String },

    #[error("Tool call failed: {tool} - {error}")]
    ToolCallFailed { tool: String, error: String },

    #[error("Server {server} not responding (timeout: {timeout_secs}s)")]
    Timeout { server: String, timeout_secs: u64 },

    #[error("Protocol error: {0}")]
    Protocol(String),
}

#[derive(Error, Debug)]
pub enum TaskError {
    #[error("Task {id} failed with exit code {exit_code}")]
    ExecutionFailed { id: Uuid, exit_code: i32 },

    #[error("Task {id} timed out after {timeout_secs}s")]
    Timeout { id: Uuid, timeout_secs: u64 },

    #[error("Circular dependency detected: {cycle:?}")]
    CircularDependency { cycle: Vec<Uuid> },

    #[error("Dependency {dep_id} failed, cannot start {task_id}")]
    DependencyFailed { task_id: Uuid, dep_id: Uuid },
}
```

### 5.2 ì—ëŸ¬ ì „íŒŒ ì •ì±…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Error Propagation Policy                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. PTY ERRORS                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  â€¢ SpawnFailed â†’ Task ìƒíƒœë¥¼ Failedë¡œ, ì˜ì¡´ íƒœìŠ¤í¬ë„ Failed     â”‚
â”‚  â€¢ PoolExhausted â†’ Queued íƒœìŠ¤í¬ ëŒ€ê¸°, ì‚¬ìš©ìì—ê²Œ ê²½ê³  í‘œì‹œ     â”‚
â”‚  â€¢ I/O Error â†’ 3íšŒ ì¬ì‹œë„ í›„ Failed                             â”‚
â”‚                                                                  â”‚
â”‚  2. MCP ERRORS                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  â€¢ ConnectionFailed â†’ 30ì´ˆ ê°„ê²© ì¬ì‹œë„ (ìµœëŒ€ 5íšŒ)               â”‚
â”‚  â€¢ Timeout â†’ ì¦‰ì‹œ ì¬ì‹œë„ 1íšŒ, ì‹¤íŒ¨ ì‹œ ì„œë²„ ìƒíƒœ "offline"       â”‚
â”‚  â€¢ ToolCallFailed â†’ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ, íƒœìŠ¤í¬ëŠ” ê³„ì† ì§„í–‰        â”‚
â”‚                                                                  â”‚
â”‚  3. TASK ERRORS                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  â€¢ Policy ì„¤ì • ê°€ëŠ¥:                                             â”‚
â”‚                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ FailFast (default)                                      â”‚  â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚  â”‚
â”‚    â”‚ í•˜ë‚˜ì˜ íƒœìŠ¤í¬ ì‹¤íŒ¨ ì‹œ ì˜ì¡´ íƒœìŠ¤í¬ë“¤ë„ ì¦‰ì‹œ ì·¨ì†Œ         â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ A(fail) â†’ B(cancelled) â†’ C(cancelled)                   â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ Continue                                                â”‚  â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚  â”‚
â”‚    â”‚ ì‹¤íŒ¨í•´ë„ ë‹¤ë¥¸ ë³‘ë ¬ íƒœìŠ¤í¬ëŠ” ê³„ì† ì§„í–‰                   â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ A(fail)  B(running) â†’ C(depends on A: skipped)          â”‚  â”‚
â”‚    â”‚          D(completed)                                   â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ Retry                                                   â”‚  â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€                                                   â”‚  â”‚
â”‚    â”‚ ì‹¤íŒ¨ ì‹œ NíšŒ ì¬ì‹œë„ (configurable)                       â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ A(fail) â†’ A(retry 1) â†’ A(retry 2) â†’ A(fail) â†’ B(cancel) â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  4. PANIC RECOVERY                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚  â€¢ std::panic::catch_unwindë¡œ íŒ¨ë‹‰ ìºì¹˜                         â”‚
â”‚  â€¢ ì„¸ì…˜ ìƒíƒœ ìë™ ì €ì¥ (crash recovery)                         â”‚
â”‚  â€¢ ì¬ì‹œì‘ ì‹œ ì´ì „ ì„¸ì…˜ ë³µêµ¬ ì˜µì…˜ ì œê³µ                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. UI ë ˆì´ì•„ì›ƒ (ìƒì„¸)

### 6.1 ê¸°ë³¸ ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ ~/project â”‚ AgTerm v0.1.0 â”‚ Tasks: 5 â”‚ â— 2 run â”‚ âœ“ 2 done â”‚ 13:45:22 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        â”‚                                                â”‚
â”‚  ğŸŒ³ Task Tree          â”‚  Terminal: build [#1] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â— running â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                        â”‚  â”‚ $ npm run build                            â”‚â”‚
â”‚  â–¼ â— [1] build         â”‚  â”‚ > webpack 5.90.0 compiled                  â”‚â”‚
â”‚    â”œâ”€â–¼ â— [2] lint      â”‚  â”‚ > 42 modules                               â”‚â”‚
â”‚    â”‚  â””â”€â—‹ [4] fix      â”‚  â”‚ > Building... â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 67%             â”‚â”‚
â”‚    â””â”€âœ“ [3] format      â”‚  â”‚                                            â”‚â”‚
â”‚  â—‹ [5] test (pending)  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                        â”‚                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  Terminal: lint [#2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â— running â”‚
â”‚  [a] Add task          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  [d] Delete selected   â”‚  â”‚ $ eslint src/ --format=compact             â”‚â”‚
â”‚  [Enter] Focus term    â”‚  â”‚ > Checking 128 files...                    â”‚â”‚
â”‚                        â”‚  â”‚ > src/utils.ts: 3 warnings                 â”‚â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚ > â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 82%                 â”‚â”‚
â”‚  MCP: â— context-7      â”‚  â”‚                                            â”‚â”‚
â”‚       â— filesystem     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚       â—‹ github         â”‚                                                â”‚
â”‚                        â”‚                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [F1]Help [F2]Tree [F3]Split [F4]Graph [F5]MCP [F6]Archive [^C]Cancel    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
â— running  âœ“ completed  âœ— failed  â—‹ pending  â— queued
```

### 6.2 ê·¸ë˜í”„ ë·° (F4)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Task Flow Graph                                    [q] Close [r] Refresh â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚                         â”‚    REQUEST    â”‚                                â”‚
â”‚                         â”‚   "ë¹Œë“œ í›„    â”‚                                â”‚
â”‚                         â”‚    í…ŒìŠ¤íŠ¸"    â”‚                                â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                 â”‚                                        â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚               â”‚                 â”‚                 â”‚                      â”‚
â”‚               â–¼                 â–¼                 â–¼                      â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚      â”‚   BUILD     â”‚   â”‚    LINT     â”‚   â”‚   FORMAT    â”‚                â”‚
â”‚      â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ â”‚   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ â”‚   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚                â”‚
â”‚      â”‚    67%      â”‚   â”‚    82%      â”‚   â”‚   100% âœ“    â”‚                â”‚
â”‚      â”‚  â— 2m 15s   â”‚   â”‚  â— 1m 30s   â”‚   â”‚  âœ“ 45s      â”‚                â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚             â”‚                 â”‚                                          â”‚
â”‚             â”‚                 â–¼                                          â”‚
â”‚             â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚             â”‚        â”‚     FIX     â”‚                                     â”‚
â”‚             â”‚        â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚                                     â”‚
â”‚             â”‚        â”‚   pending   â”‚                                     â”‚
â”‚             â”‚        â”‚ (wait:lint) â”‚                                     â”‚
â”‚             â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚             â”‚                                                            â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚                              â”‚                               â”‚          â”‚
â”‚                              â–¼                               â–¼          â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚                     â”‚    TEST     â”‚                  â”‚   DEPLOY    â”‚    â”‚
â”‚                     â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚                  â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚    â”‚
â”‚                     â”‚   pending   â”‚                  â”‚   pending   â”‚    â”‚
â”‚                     â”‚(wait:build) â”‚                  â”‚(wait:test)  â”‚    â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Nodes: 6 â”‚ Running: 2 â”‚ Completed: 1 â”‚ Pending: 3 â”‚ ETA: ~4m 30s         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 ì•„ì¹´ì´ë¸Œ ë·° (F6)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“š Session Archives                        [/] Search [Enter] Load [q] Close â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Search: npm build________                                               â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2026-01-17 10:23 â”‚ ~/project â”‚ #build #test                       â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚ npm run build ì„±ê³µ, 42 ëª¨ë“ˆ ì»´íŒŒì¼. eslint 3ê°œ ê²½ê³  ë°œìƒ.         â”‚  â”‚
â”‚  â”‚ test: 128/128 í†µê³¼. ì´ ì†Œìš” ì‹œê°„ 4ë¶„ 32ì´ˆ.                        â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚ Tasks: 5 â”‚ Success: 4 â”‚ Failed: 0 â”‚ Duration: 4m 32s              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2026-01-16 15:45 â”‚ ~/project â”‚ #build #deploy                     â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚ ë¹Œë“œ ì‹¤íŒ¨: webpack memory limit exceeded. node --max-old-space    â”‚  â”‚
â”‚  â”‚ ì˜µì…˜ ì¶”ê°€ í›„ ì¬ì‹œë„í•˜ì—¬ ì„±ê³µ. ë°°í¬ ì™„ë£Œ.                          â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚ Tasks: 3 â”‚ Success: 2 â”‚ Failed: 1 â”‚ Duration: 8m 15s              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2026-01-15 09:12 â”‚ ~/other-project â”‚ #init                        â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚ í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •. npm init, eslint ì„¤ì •, prettier ì„¤ì • ì™„ë£Œ.    â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚ Tasks: 8 â”‚ Success: 8 â”‚ Failed: 0 â”‚ Duration: 12m 05s             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Total: 47 archives â”‚ This week: 12 â”‚ Storage: 2.3 MB                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ê²€ì¦ëœ ì˜ì¡´ì„± (Cargo.toml)

```toml
[package]
name = "agterm"
version = "0.1.0"
edition = "2024"
rust-version = "1.82"  # Edition 2024 minimum
license = "MIT"
description = "AI Agent Terminal Orchestrator with MCP support"

[dependencies]
# TUI Framework (verified: v0.30.0, 2026-01)
ratatui = { version = "0.30", default-features = true }
# crossterm is included via ratatui's default features (crossterm_0_29)

# Terminal/PTY (verified: v0.9.x)
portable-pty = "0.9"

# ANSI Escape Sequence Parsing (CRITICAL - was missing in v1)
vte = "0.13"

# Async Runtime
tokio = { version = "1.43", features = ["full"] }

# MCP SDK (verified: v0.9.0, official Rust SDK)
rmcp = "0.9"

# Graph Data Structure (verified: v0.8.2)
petgraph = "0.8"

# Unique IDs
uuid = { version = "1", features = ["v4", "serde"] }

# Date/Time
chrono = { version = "0.4", features = ["serde"] }

# Serialization
serde = { version = "1", features = ["derive"] }
serde_json = "1"

# Binary serialization for archives
bincode = "1"

# SQLite (for session storage)
rusqlite = { version = "0.32", features = ["bundled"] }

# Configuration
config = "0.14"
directories = "5"

# Logging
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }

# Error Handling
thiserror = "2"
anyhow = "1"

# Async utilities
futures = "0.3"

[dev-dependencies]
# Testing
tempfile = "3"
tokio-test = "0.4"
pretty_assertions = "1"

[features]
default = ["sqlite"]
sqlite = ["rusqlite"]
# Future: MCP server mode
mcp-server = []

[profile.release]
lto = true
codegen-units = 1
panic = "abort"
```

---

## 8. ëª¨ë“ˆ êµ¬ì¡° (ìƒì„¸)

```
agterm/
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ README.md
â”œâ”€â”€ LICENSE
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs                     # Entry point, CLI args
â”‚   â”œâ”€â”€ lib.rs                      # Library root, re-exports
â”‚   â”‚
â”‚   â”œâ”€â”€ app/                        # Application layer
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ state.rs                # Global app state
â”‚   â”‚   â”œâ”€â”€ config.rs               # Configuration loading
â”‚   â”‚   â””â”€â”€ event_loop.rs           # Main event loop
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                     # Domain layer (core logic)
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ task/
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ model.rs            # TaskNode, TaskStatus, etc.
â”‚   â”‚   â”‚   â”œâ”€â”€ graph.rs            # TaskGraph operations
â”‚   â”‚   â”‚   â””â”€â”€ scheduler.rs        # Dependency-aware scheduling
â”‚   â”‚   â”œâ”€â”€ session/
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ model.rs            # Session, SessionArchive
â”‚   â”‚   â”‚   â””â”€â”€ lifecycle.rs        # Session start/end/crash recovery
â”‚   â”‚   â”œâ”€â”€ memory/
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ block.rs            # MemoryBlock implementation
â”‚   â”‚   â”‚   â””â”€â”€ compactor.rs        # Compression strategies
â”‚   â”‚   â””â”€â”€ event/
â”‚   â”‚       â”œâ”€â”€ mod.rs
â”‚   â”‚       â”œâ”€â”€ types.rs            # Event enum definitions
â”‚   â”‚       â””â”€â”€ bus.rs              # EventBus implementation
â”‚   â”‚
â”‚   â”œâ”€â”€ infrastructure/             # Infrastructure layer
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ pty/
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ pool.rs             # PTY pool management
â”‚   â”‚   â”‚   â”œâ”€â”€ session.rs          # Single PTY session
â”‚   â”‚   â”‚   â””â”€â”€ parser.rs           # ANSI parsing (vte)
â”‚   â”‚   â”œâ”€â”€ mcp/
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ client.rs           # MCP client wrapper
â”‚   â”‚   â”‚   â”œâ”€â”€ server_registry.rs  # Server connection management
â”‚   â”‚   â”‚   â””â”€â”€ tools.rs            # Tool call helpers
â”‚   â”‚   â””â”€â”€ storage/
â”‚   â”‚       â”œâ”€â”€ mod.rs
â”‚   â”‚       â”œâ”€â”€ sqlite.rs           # SQLite implementation
â”‚   â”‚       â”œâ”€â”€ migrations.rs       # Schema migrations
â”‚   â”‚       â””â”€â”€ archive.rs          # Archive read/write
â”‚   â”‚
â”‚   â”œâ”€â”€ presentation/               # Presentation layer (TUI)
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ tui.rs                  # TUI initialization
â”‚   â”‚   â”œâ”€â”€ layout.rs               # Layout management
â”‚   â”‚   â”œâ”€â”€ theme.rs                # Colors, styles
â”‚   â”‚   â”œâ”€â”€ input.rs                # Keyboard handling
â”‚   â”‚   â””â”€â”€ widgets/
â”‚   â”‚       â”œâ”€â”€ mod.rs
â”‚   â”‚       â”œâ”€â”€ task_tree.rs        # Task tree widget
â”‚   â”‚       â”œâ”€â”€ terminal_pane.rs    # Terminal output widget
â”‚   â”‚       â”œâ”€â”€ graph_view.rs       # Graph visualization
â”‚   â”‚       â”œâ”€â”€ archive_browser.rs  # Archive list widget
â”‚   â”‚       â”œâ”€â”€ mcp_panel.rs        # MCP status widget
â”‚   â”‚       â””â”€â”€ status_bar.rs       # Bottom status bar
â”‚   â”‚
â”‚   â””â”€â”€ error.rs                    # Error types (thiserror)
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ integration/
â”‚   â”‚   â”œâ”€â”€ task_graph_test.rs
â”‚   â”‚   â”œâ”€â”€ pty_pool_test.rs
â”‚   â”‚   â””â”€â”€ archive_test.rs
â”‚   â””â”€â”€ unit/
â”‚       â”œâ”€â”€ compactor_test.rs
â”‚       â”œâ”€â”€ scheduler_test.rs
â”‚       â””â”€â”€ event_bus_test.rs
â”‚
â”œâ”€â”€ benches/
â”‚   â””â”€â”€ rendering_bench.rs
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ architecture.md
    â”œâ”€â”€ context_engineering.md
    â””â”€â”€ user_guide.md
```

---

## 9. ê°œë°œ ë¡œë“œë§µ (ì„¸ë¶„í™”)

### Phase 1a: í”„ë¡œì íŠ¸ ê¸°ì´ˆ (v0.1.0-alpha.1)
- [ ] Cargo.toml ì„¤ì • ë° ì˜ì¡´ì„± í™•ì¸
- [ ] ê¸°ë³¸ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
- [ ] Error types ì •ì˜ (thiserror)
- [ ] ì„¤ì • íŒŒì¼ ë¡œë”© (config-rs)
- [ ] ë¡œê¹… ì´ˆê¸°í™” (tracing)

### Phase 1b: ë‹¨ì¼ í„°ë¯¸ë„ (v0.1.0-alpha.2)
- [ ] portable-pty ê¸°ë°˜ ë‹¨ì¼ PTY ì„¸ì…˜
- [ ] vteë¥¼ ì‚¬ìš©í•œ ANSI íŒŒì‹±
- [ ] ê¸°ë³¸ ì…ì¶œë ¥ ì²˜ë¦¬ (tokio)
- [ ] ë‹¨ì¼ í„°ë¯¸ë„ TUI (ratatui)

### Phase 1c: PTY í’€ (v0.1.0)
- [ ] PTY í’€ êµ¬í˜„ (ìµœëŒ€ ë™ì‹œ ì„¸ì…˜ ìˆ˜ ì œí•œ)
- [ ] PTY ìƒì„±/íŒŒê´´ ê´€ë¦¬
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° ë³µêµ¬

### Phase 2: ë©€í‹° í„°ë¯¸ë„ (v0.2.0)
- [ ] í„°ë¯¸ë„ ë¶„í•  (horizontal/vertical)
- [ ] í¬ì»¤ìŠ¤ ì „í™˜ (vim-style hjkl)
- [ ] í„°ë¯¸ë„ ìë™ ì¢…ë£Œ ê°ì§€
- [ ] íƒ­ ê¸°ë°˜ ê´€ë¦¬

### Phase 3: íƒœìŠ¤í¬ ê·¸ë˜í”„ (v0.3.0)
- [ ] petgraph ê¸°ë°˜ TaskGraph êµ¬í˜„
- [ ] ì˜ì¡´ì„± ê¸°ë°˜ ìŠ¤ì¼€ì¤„ëŸ¬
- [ ] íƒœìŠ¤í¬ íŠ¸ë¦¬ ìœ„ì ¯
- [ ] ì—ëŸ¬ ì „íŒŒ ì •ì±… êµ¬í˜„

### Phase 4: ì‹œê°í™” (v0.4.0)
- [ ] ê·¸ë˜í”„ ë·° ìœ„ì ¯ (ASCII art)
- [ ] ì‹¤ì‹œê°„ ì§„í–‰ë¥  í‘œì‹œ
- [ ] ë…¸ë“œ ìƒì„¸ ì •ë³´ íŒì—…
- [ ] íƒ€ì´ë¨¸ ë° ETA í‘œì‹œ

### Phase 5: MCP í†µí•© (v0.5.0)
- [ ] rmcp ê¸°ë°˜ MCP í´ë¼ì´ì–¸íŠ¸
- [ ] ì„œë²„ ì—°ê²° ê´€ë¦¬ (stdio/SSE)
- [ ] Tool í˜¸ì¶œ UI
- [ ] MCP ìƒíƒœ íŒ¨ë„

### Phase 6: ì•„ì¹´ì´ë¹™ (v0.6.0)
- [ ] SQLite ì €ì¥ì†Œ êµ¬í˜„
- [ ] Compaction íŒŒì´í”„ë¼ì¸
- [ ] AI ìš”ì•½ í†µí•© (optional, configurable)
- [ ] ì•„ì¹´ì´ë¸Œ ë¸Œë¼ìš°ì € UI
- [ ] ì „ë¬¸ ê²€ìƒ‰ (FTS5)

### Phase 7: ì•ˆì •í™” (v1.0.0)
- [ ] í…Œë§ˆ ì»¤ìŠ¤í„°ë§ˆì´ì§•
- [ ] í‚¤ë°”ì¸ë”© ì„¤ì •
- [ ] í¬ë¡œìŠ¤ í”Œë«í¼ í…ŒìŠ¤íŠ¸ (macOS, Linux, Windows)
- [ ] ì„±ëŠ¥ ìµœì í™”
- [ ] ë¬¸ì„œí™” ì™„ì„±
- [ ] CI/CD íŒŒì´í”„ë¼ì¸

---

## 10. ì„±ëŠ¥ ëª©í‘œ

| ë©”íŠ¸ë¦­ | ëª©í‘œì¹˜ | ì¸¡ì • ë°©ë²• |
|--------|--------|----------|
| UI ë Œë”ë§ | 60 FPS | frame time < 16ms |
| í‚¤ ì…ë ¥ ì§€ì—° | < 10ms | ì…ë ¥ â†’ í™”ë©´ ë°˜ì˜ |
| ë™ì‹œ PTY ì„¸ì…˜ | ìµœëŒ€ 32ê°œ | configurable |
| ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ | < 200MB (idle) | 32 PTY ì„¸ì…˜ ê¸°ì¤€ |
| SQLite ì¿¼ë¦¬ | < 50ms | ì•„ì¹´ì´ë¸Œ ê²€ìƒ‰ |
| MCP ì‘ë‹µ | < 500ms | tool call round-trip |

---

## 11. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 11.1 PTY ë³´ì•ˆ
- PTYëŠ” ì„ì˜ ëª…ë ¹ ì‹¤í–‰ ê°€ëŠ¥ â†’ ì‚¬ìš©ì ì…ë ¥ë§Œ í—ˆìš©
- í™˜ê²½ ë³€ìˆ˜ ì£¼ì… ë°©ì§€ (`PATH` ë“± í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸)

### 11.2 MCP ë³´ì•ˆ
- ì„œë²„ë³„ permission ì„¤ì • (read-only, execute ë“±)
- API keyëŠ” OS keychain ë˜ëŠ” í™˜ê²½ ë³€ìˆ˜ì—ì„œë§Œ ë¡œë“œ
- ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì€ TLS í•„ìˆ˜ (SSE/HTTP)

### 11.3 ì•„ì¹´ì´ë¸Œ ë³´ì•ˆ
- ë¯¼ê° ì •ë³´ íŒ¨í„´ ê°ì§€ (API key, password ë“±)
- ìš”ì•½ ì‹œ ë¯¼ê° ì •ë³´ ë§ˆìŠ¤í‚¹
- ì•„ì¹´ì´ë¸Œ íŒŒì¼ ì•”í˜¸í™” ì˜µì…˜ (AES-256)

---

## 12. ì°¸ê³  ìë£Œ

### í„°ë¯¸ë„ & TUI
- [ratatui](https://ratatui.rs/) - Rust TUI í”„ë ˆì„ì›Œí¬
- [portable-pty](https://docs.rs/portable-pty) - í¬ë¡œìŠ¤ í”Œë«í¼ PTY
- [vte](https://docs.rs/vte) - ANSI íŒŒì‹±
- [Zellij Architecture](https://github.com/zellij-org/zellij) - Rust í„°ë¯¸ë„ ë©€í‹°í”Œë ‰ì„œ ì°¸ì¡°

### MCP
- [rmcp (Official Rust SDK)](https://github.com/4t145/rmcp) - v0.9.0
- [MCP Specification](https://modelcontextprotocol.io/)

### Context Engineering
- [Anthropic - Effective Context Engineering](https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents)
- [LangChain Context Engineering](https://www.blog.langchain.com/context-engineering-for-agents/)
- [Factory.ai - Compressing Context](https://factory.ai/news/compressing-context)
- [Letta Memory Blocks](https://www.letta.com/blog/memory-blocks)

### Graph & Visualization
- [petgraph](https://github.com/petgraph/petgraph) - v0.8.2

### Multi-Agent Orchestration
- [Claude Code Subagents](https://code.claude.com/docs/en/sub-agents)
- [Claude-Flow](https://github.com/ruvnet/claude-flow)
- [Agentic AI Trends 2026](https://thenewstack.io/5-key-trends-shaping-agentic-development-in-2026/)

---

## 13. ë‹¤ìŒ ë‹¨ê³„

ì´ ê³„íšì„œë¥¼ ê²€í† í•˜ì‹  í›„ ìŠ¹ì¸í•´ ì£¼ì‹œë©´ Phase 1aë¶€í„° êµ¬í˜„ì„ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤.

**v1 ëŒ€ë¹„ ì£¼ìš” ê°œì„  ì‚¬í•­:**
1. âœ… ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ ê²€ì¦ ì™„ë£Œ (rmcp 0.9, petgraph 0.8, ratatui 0.30)
2. âœ… vte ì˜ì¡´ì„± ì¶”ê°€ (ANSI íŒŒì‹±)
3. âœ… ì•„í‚¤í…ì²˜ ë ˆì´ì–´ ê°„ ì˜ì¡´ì„± ë°©í–¥ ëª…í™•í™”
4. âœ… MCP í´ë¼ì´ì–¸íŠ¸/ì„œë²„ ì—­í•  ëª…í™•í™”
5. âœ… Context Engineering íŒ¨í„´ ìƒì„¸í™” (Write, Select, Compress, Isolate)
6. âœ… Compaction ì „ëµ êµ¬ì²´í™”
7. âœ… ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ ì¶”ê°€
8. âœ… Phase ì„¸ë¶„í™” (1a, 1b, 1c)
9. âœ… ì„±ëŠ¥ ëª©í‘œ ë° ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ ì¶”ê°€
10. âœ… SQLite ìŠ¤í‚¤ë§ˆ ì •ì˜
